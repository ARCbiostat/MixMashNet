% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/community_scores.R
\name{community_scores}
\alias{community_scores}
\title{Compute community scores from a fitted MixMashNet model}
\usage{
community_scores(
  fit,
  data = NULL,
  layer = NULL,
  scale = TRUE,
  conf_level = 0.95,
  return_ci = FALSE,
  na_action = c("stop", "omit")
)
}
\arguments{
\item{fit}{A fitted object of class \code{c("mixmashnet","mixMN_fit", "multimixMN_fit")}
returned by \code{mixMN()} or \code{multimixMN()}.}

\item{data}{Optional matrix/data.frame with variables in columns. If
\code{NULL}, uses \code{fit$model$data}. Errors if both are \code{NULL}.}

\item{layer}{Optional. If fit is a multimixMN_fit, specify which layer to score (name or index).
If NULL, scores are computed for all layers and returned as a named list.}

\item{scale}{Logical; if \code{TRUE} (default), z-standardize variables used
for scoring, using the mean/SD computed from the dataset used for scoring.}

\item{conf_level}{Optional numeric in (0,1), e.g. 0.95 or 0.99. If provided,
percentile bootstrap confidence intervals are computed for community scores
(requires \code{fit$community_loadings$boot}).}

\item{return_ci}{Logical; if \code{TRUE}, return CIs.}

\item{na_action}{Character. How to handle missing values in the scoring data:
\code{"stop"} (default) stops if any missing value is present in the
required variables; \code{"omit"} computes scores using row-wise omission
within each community (i.e., uses available variables only, re-normalizing
weights within community for that row).}
}
\value{
A list with class \code{c("mixmashnet","community_scores")} containing:
\describe{
\item{\code{call}}{The matched call.}
\item{\code{settings}}{List with \code{scale}, \code{conf_level}, and \code{na_action}.}
\item{\code{ids}}{Character vector of subject IDs (rownames of \code{data}).}
\item{\code{communities}}{Character vector of community score names.}
\item{\code{scores}}{Numeric matrix of scores (n × K).}
\item{\code{ci}}{If requested and available, a list with \code{lower} and \code{upper}
matrices (n × K) for percentile bootstrap CIs; otherwise \code{NULL}.}
\item{\code{details}}{List containing \code{nodes_used}, \code{loadings_true},
\code{loadings_boot_available}, and scaling parameters (\code{center}, \code{scale}).}
}
If \code{fit} is a \code{mixMN_fit} (or a \code{multimixMN_fit} with \code{layer} specified),
returns a \code{c("mixmashnet","community_scores")} object.
If \code{fit} is a \code{multimixMN_fit} and \code{layer = NULL}, returns a named list
of \code{community_scores} objects (one per layer).
}
\description{
Computes subject-level community scores using the community loadings stored
in a fitted \code{mixMN_fit} object (output of \code{mixMN()}).

Scores are computed as weighted sums of variables within each community
(based on \code{EGAnet::net.loads} standardized loadings saved in
\code{fit$community_loadings$true}).

By default, variables are z-standardized (\code{scale = TRUE}) using the
dataset actually used for scoring (i.e., the provided \code{data}; if
\code{data = NULL}, the function uses \code{fit$model$data}). This matches
your preference: scaling is done on the data you have in hand.

Optionally, confidence intervals (percentile bootstrap) for the community
scores can be computed if bootstrap loadings are available in
\code{fit$community_loadings$boot}.
}
\details{
The function requires that \code{fit$community_loadings$true} exists and that
the input \code{data} contains all required variables in
\code{fit$community_loadings$nodes}. It errors otherwise.

Confidence intervals:
\itemize{
\item If \code{conf_level} is provided and \code{fit$community_loadings$boot}
is available, the function computes community scores for each bootstrap
loading matrix and returns percentile CIs across replications for each
subject and community.
\item If bootstrap loadings are missing, the function errors when CI is requested.
}
}
