% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multimixMN.R
\name{multimixMN}
\alias{multimixMN}
\title{Multilayer MGM with bootstrap, intra/interlayer metrics, and CIs}
\usage{
multimixMN(
  data,
  layers,
  layer_rules,
  scale = TRUE,
  reps = 100,
  lambdaSel = c("CV", "EBIC"),
  lambdaFolds = 5,
  lambdaGam = 0.25,
  alphaSeq = 1,
  alphaSel = "CV",
  alphaFolds = 5,
  alphaGam = 0.25,
  k = 2,
  ruleReg = "AND",
  threshold = "LW",
  overparameterize = FALSE,
  thresholdCat = TRUE,
  conf_level = 0.95,
  covariates = NULL,
  exclude_from_cluster = NULL,
  seed_model = NULL,
  seed_boot = NULL,
  treat_singletons_as_excluded = FALSE,
  cluster_method = c("louvain", "fast_greedy", "infomap", "walktrap", "edge_betweenness"),
  compute_loadings = TRUE,
  boot_what = c("general_index", "interlayer_index", "bridge_index", "excluded_index",
    "community", "loadings"),
  save_data = FALSE,
  progress = TRUE
)
}
\arguments{
\item{data}{A data.frame (n x p) with variables in columns.
Character variables are not allowed and must be converted to \code{factor}
or \code{numeric} types before fitting.}

\item{layers}{A named vector (names = variable names) assigning each node to a
layer (character or factor). Must cover all columns of \code{data}
except variables listed in \code{covariates} (treated as adjustment covariates).}

\item{layer_rules}{A logical or numeric square matrix with row/column names
equal to layer names. Values \code{TRUE} or \code{1} indicate that
cross-layer edges are allowed between the corresponding layer pair.
Intralayer edges are always allowed.}

\item{scale}{Logical; if \code{TRUE} (default) Gaussian variables
(\code{type == "g"}) are z-standardized internally by \code{mgm()}. Use
\code{scale = FALSE} if your data are already standardized.}

\item{reps}{Integer (>= 0). Number of bootstrap replications (row resampling
with replacement). If \code{reps = 0}, no bootstrap is performed.}

\item{lambdaSel}{Method for lambda selection in \code{mgm}:
\code{"CV"} or \code{"EBIC"}.}

\item{lambdaFolds}{Number of folds for CV (if \code{lambdaSel = "CV"}).}

\item{lambdaGam}{EBIC gamma parameter (if \code{lambdaSel = "EBIC"}).}

\item{alphaSeq}{Alpha parameters of the elastic net penalty (values between 0 and 1).}

\item{alphaSel}{Method for selecting the alpha parameter:
\code{"CV"} or \code{"EBIC"}.}

\item{alphaFolds}{Number of folds for CV (if \code{alphaSel = "CV"}).}

\item{alphaGam}{EBIC gamma parameter (if \code{alphaSel = "EBIC"}).}

\item{k}{Integer (>= 1). Order of modeled interactions.}

\item{ruleReg}{Rule to combine neighborhood estimates:
\code{"AND"} or \code{"OR"}.}

\item{threshold}{Threshold below which edge-weights are set to zero:
\code{"LW"}, \code{"HW"} or \code{"none"}.}

\item{overparameterize}{Logical; if \code{TRUE} uses the over-parameterized
version of \code{mgm}.}

\item{thresholdCat}{Logical; if \code{FALSE} thresholds of categorical
variables are set to zero.}

\item{conf_level}{Confidence level for percentile bootstrap CIs (default 0.95).
Must be a single number between 0 and 1 (e.g., 0.90, 0.95, 0.99).}

\item{covariates}{Character vector. Variables used as adjustment covariates
in model estimation.}

\item{exclude_from_cluster}{Character vector of node names. Nodes in this set
are excluded from community detection in addition to \code{covariates}.}

\item{seed_model}{Optional integer seed for reproducibility of the initial
MGM fit.}

\item{seed_boot}{Optional integer seed passed to \code{future.apply} for
reproducibility of bootstrap replications.}

\item{treat_singletons_as_excluded}{Logical; if \code{TRUE}, singleton
communities (size 1) are treated as "excluded" when computing bridge
metrics and related summaries.}

\item{cluster_method}{Community detection algorithm applied within each
layer. One of \code{"louvain"}, \code{"fast_greedy"}, \code{"infomap"},
\code{"walktrap"}, or \code{"edge_betweenness"}.}

\item{compute_loadings}{Logical; if \code{TRUE} (default),
compute network loadings (EGAnet net.loads) for communities.}

\item{boot_what}{Character vector specifying which quantities to bootstrap.
Valid options are:
\code{"general_index"} (intralayer centrality indices),
\code{"interlayer_index"} (interlayer-only node metrics),
\code{"bridge_index"} (bridge metrics for nodes in communities),
\code{"excluded_index"} (bridge metrics for nodes treated as excluded),
\code{"community"} (community memberships),
\code{"loadings"} (within-layer community loadings, only if
\code{compute_loadings = TRUE}),
and \code{"none"} (skip all node-level bootstrap: only edge-weight
bootstrap is performed if \code{reps > 0}).}

\item{save_data}{Logical; if \code{TRUE}, store the original data in the output object.}

\item{progress}{Logical; if \code{TRUE} (default), show a bootstrap progress bar.}
}
\value{
An object of class \code{c("mixmashnet", "multimixMN_fit")}. The returned
list contains at least the following components:
\describe{
  \item{\code{call}}{
  The matched function call.
  }
 \item{\code{data_info}}{
    List with information derived from the input data used for model setup:
    \code{mgm_type_level} (data frame with one row per variable, reporting
    the original R class and the inferred MGM \code{type} and \code{level},
    as used in the call to \code{mgm::mgm}),
    and \code{binary_recode_map} (named list describing the mapping from
    original binary labels to the internal \{0,1\} coding used for model fitting).
  }
  \item{\code{settings}}{
  List of main settings used in the call, including
   \code{reps}, \code{cluster_method}, \code{covariates},
    \code{exclude_from_cluster}, \code{treat_singletons_as_excluded},
    \code{boot_what}).
  }
  \item{\code{model}}{
    List with:
    \code{mgm} (the fitted \code{mgm} object),
    \code{nodes} (character vector of all node names),
    \code{n} (number of observations),
    \code{p} (number of variables), and
    \code{data}.
  }
  \item{\code{layers}}{
   List describing the multilayer structure
    (assignment of nodes to layers, \code{layer_rules} matrix used and color of each layer in \code{palette}).
  }
  \item{\code{layer_fits}}{
   Named list (one element per layer) with
    single layer fits, including community structure, node-level statistics,
    edge-level statistics, bridge metrics, and (optionally) community loadings
    with bootstrap information.
  }
  \item{\code{interlayer}}{
  List collecting interlayer-only node metrics
  (strength, expected influence, closeness, betweenness, with or without
  bootstrap) and cross-layer edge summaries for each allowed pair of
  layers.
  }
  \item{\code{graph}}{
  List containing a global \pkg{igraph} object built on
  the retained nodes (\code{keep_nodes_graph}), with vertex attributes
  such as \code{name}, \code{layer}, \code{membership}, and edge attributes
  such as \code{weight}, \code{abs_weight}, \code{sign},
  \code{type} (intra vs inter) and \code{layer_pair}.
  }
}
}
\description{
Estimates a multilayer Mixed Graphical Model (MGM) using the estimation
framework implemented in the \pkg{mgm} package, with a masking scheme that
enforces which cross-layer edges are allowed according to \code{layer_rules}.
Within each layer, the function computes community structure and performs
non-parametric row-bootstrap to obtain node centrality indices, edge weights,
and bridge metrics, including metrics for nodes treated as excluded. Optionally,
within-layer community loadings can also be estimated and bootstrapped.
The function additionally returns interlayer-only node metrics and summaries
of cross-layer edge weights.
}
\details{
This function does \strong{not} call \code{future::plan()}. To enable
parallel bootstrap, set a plan (e.g. \code{future::plan(multisession)}) before
calling \code{multimixMN()}. If \code{"none"} is the only element of
\code{boot_what} and \code{reps > 0}, node-level metrics are not
bootstrapped, but intra and interlayer edge-weight bootstrap and the
corresponding confidence intervals are still computed.
}
\references{
Haslbeck, J. M. B., & Waldorp, L. J. (2020).
mgm: Estimating Time-Varying Mixed Graphical Models in High-Dimensional Data.
\emph{Journal of Statistical Software}, 93(8).
\doi{10.18637/jss.v093.i08}
}
