<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate single layer MGM network with bootstrap centrality, bridge metrics, clustering, and (optionally) community scores with CIs — mixMN • MixMashNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate single layer MGM network with bootstrap centrality, bridge metrics, clustering, and (optionally) community scores with CIs — mixMN"><meta name="description" content="Estimates a single layer Mixed Graphical Model (MGM) network on the original data,
using the estimation framework implemented in the mgm package, and performs
non-parametric bootstrap (row resampling) to compute centrality indices, bridge
metrics, clustering stability, and confidence intervals (CIs) for node metrics
and edge weights.
Optionally, the function computes community score loadings (for later prediction
on new data) and can bootstrap the corresponding loadings."><meta property="og:description" content="Estimates a single layer Mixed Graphical Model (MGM) network on the original data,
using the estimation framework implemented in the mgm package, and performs
non-parametric bootstrap (row resampling) to compute centrality indices, bridge
metrics, clustering stability, and confidence intervals (CIs) for node metrics
and edge weights.
Optionally, the function computes community score loadings (for later prediction
on new data) and can bootstrap the corresponding loadings."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MixMashNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-apps" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Apps</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-apps"><li><a class="dropdown-item" href="../articles/shiny-single.html">Single-layer</a></li>
    <li><a class="dropdown-item" href="../articles/shiny-multilayer.html">Multilayer</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ARCbiostat/MixMashNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate single layer MGM network with bootstrap centrality, bridge metrics, clustering, and (optionally) community scores with CIs</h1>
      <small class="dont-index">Source: <a href="https://github.com/ARCbiostat/MixMashNet/blob/HEAD/R/mixMN.R" class="external-link"><code>R/mixMN.R</code></a></small>
      <div class="d-none name"><code>mixMN.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates a single layer Mixed Graphical Model (MGM) network on the original data,
using the estimation framework implemented in the <span class="pkg">mgm</span> package, and performs
non-parametric bootstrap (row resampling) to compute centrality indices, bridge
metrics, clustering stability, and confidence intervals (CIs) for node metrics
and edge weights.
Optionally, the function computes community score loadings (for later prediction
on new data) and can bootstrap the corresponding loadings.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mixMN</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">level</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambdaSel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CV"</span>, <span class="st">"EBIC"</span><span class="op">)</span>,</span>
<span>  lambdaFolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  lambdaGam <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  alphaSeq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alphaSel <span class="op">=</span> <span class="st">"CV"</span>,</span>
<span>  alphaFolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  alphaGam <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ruleReg <span class="op">=</span> <span class="st">"AND"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="st">"LW"</span>,</span>
<span>  overparameterize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thresholdCat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_from_cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  treat_singletons_as_excluded <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed_boot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"louvain"</span>, <span class="st">"fast_greedy"</span>, <span class="st">"infomap"</span>, <span class="st">"walktrap"</span>, <span class="st">"edge_betweenness"</span><span class="op">)</span>,</span>
<span>  compute_loadings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boot_what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"general_index"</span>, <span class="st">"bridge_index"</span>, <span class="st">"excluded_index"</span>, <span class="st">"community"</span>,</span>
<span>    <span class="st">"loadings"</span><span class="op">)</span>,</span>
<span>  save_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Matrix or data.frame (n x p) with variables in columns.</p></dd>


<dt id="arg-type-level">type, level<a class="anchor" aria-label="anchor" href="#arg-type-level"></a></dt>
<dd><p>Vectors as required by <code><a href="https://rdrr.io/pkg/mgm/man/mgm.html" class="external-link">mgm::mgm</a></code>.</p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>Integer (&gt;= 0). Number of bootstrap replications.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default) Gaussian variables
(<code>type == "g"</code>) are z-standardized internally by <code>mgm()</code>. Use
<code>scale = FALSE</code> if your data are already standardized.</p></dd>


<dt id="arg-lambdasel">lambdaSel<a class="anchor" aria-label="anchor" href="#arg-lambdasel"></a></dt>
<dd><p>Method for lambda selection: <code>"CV"</code> or <code>"EBIC"</code>.</p></dd>


<dt id="arg-lambdafolds">lambdaFolds<a class="anchor" aria-label="anchor" href="#arg-lambdafolds"></a></dt>
<dd><p>Number of folds for CV (if <code>lambdaSel = "CV"</code>).</p></dd>


<dt id="arg-lambdagam">lambdaGam<a class="anchor" aria-label="anchor" href="#arg-lambdagam"></a></dt>
<dd><p>EBIC gamma parameter (if <code>lambdaSel = "EBIC"</code>).</p></dd>


<dt id="arg-alphaseq">alphaSeq<a class="anchor" aria-label="anchor" href="#arg-alphaseq"></a></dt>
<dd><p>Alpha parameters of the elastic net penalty (values between 0 and 1).</p></dd>


<dt id="arg-alphasel">alphaSel<a class="anchor" aria-label="anchor" href="#arg-alphasel"></a></dt>
<dd><p>Method for selecting the alpha parameter: <code>"CV"</code> or <code>"EBIC"</code>.</p></dd>


<dt id="arg-alphafolds">alphaFolds<a class="anchor" aria-label="anchor" href="#arg-alphafolds"></a></dt>
<dd><p>Number of folds for CV (if <code>alphaSel = "CV"</code>).</p></dd>


<dt id="arg-alphagam">alphaGam<a class="anchor" aria-label="anchor" href="#arg-alphagam"></a></dt>
<dd><p>EBIC gamma parameter (if <code>alphaSel = "EBIC"</code>).</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Integer (&gt;= 1). Order of modeled interactions.</p></dd>


<dt id="arg-rulereg">ruleReg<a class="anchor" aria-label="anchor" href="#arg-rulereg"></a></dt>
<dd><p>Rule to combine neighborhood estimates: <code>"AND"</code> or <code>"OR"</code>.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Threshold below which edge-weights are set to zero:
<code>"LW"</code>, <code>"HW"</code> or <code>"none"</code>.</p></dd>


<dt id="arg-overparameterize">overparameterize<a class="anchor" aria-label="anchor" href="#arg-overparameterize"></a></dt>
<dd><p>Logical; if <code>TRUE</code> uses the over-parameterized
version of <code>mgm</code>.</p></dd>


<dt id="arg-thresholdcat">thresholdCat<a class="anchor" aria-label="anchor" href="#arg-thresholdcat"></a></dt>
<dd><p>Logical; if <code>FALSE</code> thresholds of categorical
variables are set to zero.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level for percentile bootstrap CIs (default 0.95).
Must be a single number between 0 and 1.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Character vector. Nodes excluded from the graph and
from all node-level metrics.</p></dd>


<dt id="arg-exclude-from-cluster">exclude_from_cluster<a class="anchor" aria-label="anchor" href="#arg-exclude-from-cluster"></a></dt>
<dd><p>Character vector. Nodes excluded from community
detection (in addition to <code>covariates</code>).</p></dd>


<dt id="arg-treat-singletons-as-excluded">treat_singletons_as_excluded<a class="anchor" aria-label="anchor" href="#arg-treat-singletons-as-excluded"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, singleton
communities (size 1) are treated as excluded nodes when computing
bridge metrics.</p></dd>


<dt id="arg-seed-model-seed-boot">seed_model, seed_boot<a class="anchor" aria-label="anchor" href="#arg-seed-model-seed-boot"></a></dt>
<dd><p>Optional numeric seeds for reproducibility of the
original MGM fit and bootstrap replications, respectively.</p></dd>


<dt id="arg-cluster-method">cluster_method<a class="anchor" aria-label="anchor" href="#arg-cluster-method"></a></dt>
<dd><p>Community detection algorithm used on the network:
<code>"louvain"</code>, <code>"fast_greedy"</code>, <code>"infomap"</code>,
<code>"walktrap"</code>, or <code>"edge_betweenness"</code>.</p></dd>


<dt id="arg-compute-loadings">compute_loadings<a class="anchor" aria-label="anchor" href="#arg-compute-loadings"></a></dt>
<dd><p>Logical; if TRUE (default),
compute network loadings (EGAnet net.loads) for communities.</p></dd>


<dt id="arg-boot-what">boot_what<a class="anchor" aria-label="anchor" href="#arg-boot-what"></a></dt>
<dd><p>Character vector specifying which quantities to bootstrap.
Can include:</p><ul><li><p><code>"general_index"</code>: strength, expected influence 1-step,
    harmonic closeness, betweenness.</p></li>
<li><p><code>"bridge_index"</code>: bridge strength, bridge expected influence
    1- and 2-step, bridge closeness, bridge betweenness (nodes in
    communities).</p></li>
<li><p><code>"excluded_index"</code>: bridge metrics for nodes excluded from
    communities (or treated as such).</p></li>
<li><p><code>"community"</code>: bootstrap community memberships.</p></li>
<li><p><code>"loadings"</code>: bootstrap loadings
    (only if <code>compute_loadings = TRUE</code>).</p></li>
<li><p><code>"none"</code>: skip node-level bootstrap (edge-weight bootstrap is
    still performed if <code>reps &gt; 0</code>).</p></li>
</ul></dd>


<dt id="arg-save-data">save_data<a class="anchor" aria-label="anchor" href="#arg-save-data"></a></dt>
<dd><p>Logical; if TRUE, store the original data in the output object.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), show a bootstrap progress
bar when the <span class="pkg">progressr</span> package is available.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>c("mixmashnet", "mixMN_fit")</code>, that is a list with
the following top-level components:</p><dl><dt><code>call</code></dt>
<dd><p>The matched function call.</p></dd>

  <dt><code>settings</code></dt>
<dd><p>List of main settings used in the call, including
    <code>reps</code>, <code>cluster_method</code>,
    <code>covariates</code>, <code>exclude_from_cluster</code>,
    <code>treat_singletons_as_excluded</code>, and <code>boot_what</code>.</p></dd>

  <dt><code>model</code></dt>
<dd><p>List with:
    <code>mgm</code> (the fitted <code>mgm</code> object),
    <code>nodes</code> (character vector of all node names),
    <code>n</code> (number of observations),
    <code>p</code> (number of variables), and
    <code>data</code>.</p></dd>

  <dt><code>graph</code></dt>
<dd><p>List describing the graph:
    <code>igraph</code> (an <span class="pkg">igraph</span> object built on
    <code>keep_nodes_graph</code>, with edge attributes
    <code>weight</code>, <code>abs_weight</code>, <code>sign</code> and vertex attribute
    <code>membership</code> for communities),
    <code>keep_nodes_graph</code> (nodes retained in the graph and all node-level
    metrics), and <code>keep_nodes_cluster</code> (nodes used for community
    detection).</p></dd>

  <dt><code>communities</code></dt>
<dd><p>List describing community structure with:
    <code>original_membership</code> (integer vector of community labels on
    <code>keep_nodes_cluster</code>),
    <code>groups</code> (factor of community labels actually used for bridge
    metrics, optionally with singletons treated as excluded),
    <code>palette</code> (named vector of colors per community), and
    <code>boot_memberships</code> (list of bootstrap memberships if
    <code>"community"</code> is requested in <code>boot_what</code>, otherwise an empty
    list).</p></dd>

  <dt><code>statistics</code></dt>
<dd><p>List with node- and edge-level summaries:
    <code>node</code> is a list with:
    <code>true</code> (data frame with one row per node in
    <code>keep_nodes_graph</code>, containing the node name and metrics
    <code>strength</code>, <code>ei1</code>, <code>closeness</code>, <code>betweenness</code>,
    <code>bridge_strength</code>, <code>bridge_betweenness</code>, <code>bridge_closeness</code>,
    <code>bridge_ei1</code>, <code>bridge_ei2</code>, and for nodes treated as excluded
    from communities also
    <code>bridge_strength_excluded</code>,
    <code>bridge_betweenness_excluded</code>,
    <code>bridge_closeness_excluded</code>,
    <code>bridge_ei1_excluded</code>, <code>bridge_ei2_excluded</code>);
    <code>boot</code> (list of bootstrap matrices for each metric, each of
    dimension <code>reps x length(keep_nodes_graph)</code>, possibly <code>NULL</code>
    if the metric was not requested or if <code>reps = 0</code>); and
    <code>ci</code> (list of CIs for each node metric, one
    <code>p x 2</code> matrix per metric, with columns <code>2.5%</code> and
    <code>97.5%</code>, or <code>NULL</code> if no bootstrap was performed).</p>
<p><code>edge</code> is a list with:
    <code>true</code> (data frame with columns <code>edge</code> and <code>weight</code> for
    all unique undirected edges among <code>keep_nodes_graph</code>);
    <code>boot</code> (matrix of bootstrap edge weights of dimension
    <code>n_edges x reps</code>); and
    <code>ci</code> (matrix of CIs for edge weights,
    <code>n_edges x 2</code>, with columns <code>2.5%</code> and <code>97.5%</code>, or
    <code>NULL</code> if <code>reps = 0</code>).</p></dd>

  <dt><code>community_loadings</code></dt>
<dd><p>List containing community-loading information (based on
    <code><a href="https://r-ega.net/reference/net.loads.html" class="external-link">EGAnet::net.loads</a></code>) for later community-score computation on new
    data:
    <code>nodes</code> (nodes used for loadings),
    <code>wc</code> (integer community labels aligned with <code>nodes</code>),
    <code>true</code> (matrix of standardized loadings, nodes x communities),
    and <code>boot</code> (list of bootstrap loading matrices, one per replication,
    or <code>NULL</code> if not bootstrapped).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function does <strong>not</strong> call <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code>. To enable
parallel bootstrap, set a plan (e.g. <code>future::plan(multisession)</code>)
before calling <code>mixMN()</code>. If <code>boot_what</code> is <code>"none"</code> and
<code>reps &gt; 0</code>, node-level metrics are not bootstrapped but edge-weight
bootstrap and corresponding CIs are still computed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Haslbeck, J. M. B., &amp; Waldorp, L. J. (2020).
mgm: Estimating Time-Varying Mixed Graphical Models in High-Dimensional Data.
<em>Journal of Statistical Software</em>, 93(8).
<a href="https://doi.org/10.18637/jss.v093.i08" class="external-link">doi:10.18637/jss.v093.i08</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maria De Martino, Caterina Gregorio.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

